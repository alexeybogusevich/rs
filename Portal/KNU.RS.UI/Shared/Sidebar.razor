@inject IJSRuntime JsRuntime
@inject NavigationManager navManager

<div class="sidebar" id="sidebar">
    <div class="sidebar-inner slimscroll">
        <div id="sidebar-menu" class="sidebar-menu">
            <ul>
                <li class="menu-title">Головна</li>
                <AuthorizeView Roles="Admin,Doctor">
                    <Authorized>
                        <li class="@panelClass">
                            <a href="/main" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-dashboard"></i> <span>Панель</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
                <AuthorizeView Roles="Admin">
                    <Authorized>
                        <li class="@doctorsClass">
                            <a href="/doctors" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-user-md"></i> <span>Лікарі</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
                <AuthorizeView Roles="Doctor">
                    <Authorized>
                        <li class="@myPatientsClass">
                            <a href="/mypatients" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-book"></i> <span>Мої пацієнти</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
                <AuthorizeView Roles="Admin">
                    <Authorized>
                        <li class="@patientsClass">
                            <a href="/patients" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-wheelchair"></i> <span>Пацієнти</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
                <AuthorizeView Roles="Doctor">
                    <Authorized>
                        <li class="@myDoctorProfileClass">
                            <a href="/mydoctorprofile" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-id-card-o"></i> <span>Мій профіль лікаря</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
                <AuthorizeView Roles="Patient">
                    <Authorized>
                        <li class="@myRecoveryPlansClass">
                            <a href="/myrecoveryplans" @onclick="async () => await CloseSidebarAsync()"><i class="fa fa-calendar-check-o"></i> <span>Мої вправи</span></a>
                        </li>
                    </Authorized>
                </AuthorizeView>
            </ul>
        </div>
    </div>
</div>

@code {
    private string currentUri => navManager.ToBaseRelativePath(navManager.Uri);
    private string panelClass => currentUri.Equals("main") ? "active" : "";
    private string doctorsClass => currentUri.Contains("doctor") && !currentUri.Contains("mydoctorprofile") ? "active" : "";
    private string patientsClass => currentUri.Contains("patient") && !currentUri.Contains("mypatients") ? "active" : "";
    private string myPatientsClass => currentUri.Contains("mypatients") ? "active" : "";
    private string myDoctorProfileClass => currentUri.Contains("mydoctorprofile") ? "active" : "";
    private string myRecoveryPlansClass => currentUri.Contains("myrecoveryplans") ? "active" : "";

    private async Task CloseSidebarAsync()
    {
        await JsRuntime.InvokeVoidAsync(JSExtensionMethods.CloseSidebar);
    }
}